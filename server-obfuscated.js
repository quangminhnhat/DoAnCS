function a0_0x2782(_0x52fc7a,_0x4af595){const _0x1f42b6=a0_0x1f42();return a0_0x2782=function(_0x2782c1,_0x19fba0){_0x2782c1=_0x2782c1-0xbb;let _0x1d792b=_0x1f42b6[_0x2782c1];return _0x1d792b;},a0_0x2782(_0x52fc7a,_0x4af595);}const a0_0x27126c=a0_0x2782;(function(_0x18495a,_0x22a17d){const _0x59ff07=a0_0x2782,_0x40cdb8=_0x18495a();while(!![]){try{const _0x18636f=parseInt(_0x59ff07(0x167))/0x1+-parseInt(_0x59ff07(0xdf))/0x2+parseInt(_0x59ff07(0x18e))/0x3+parseInt(_0x59ff07(0x132))/0x4*(-parseInt(_0x59ff07(0x102))/0x5)+parseInt(_0x59ff07(0x196))/0x6*(-parseInt(_0x59ff07(0xcd))/0x7)+-parseInt(_0x59ff07(0x199))/0x8*(parseInt(_0x59ff07(0x1ac))/0x9)+parseInt(_0x59ff07(0xdb))/0xa;if(_0x18636f===_0x22a17d)break;else _0x40cdb8['push'](_0x40cdb8['shift']());}catch(_0x3989c7){_0x40cdb8['push'](_0x40cdb8['shift']());}}}(a0_0x1f42,0xb917f));process[a0_0x27126c(0xe9)][a0_0x27126c(0xe6)]!=='production'&&require('dotenv')['config']();const express=require(a0_0x27126c(0xd5)),app=express(),path=require('path'),bcrypt=require(a0_0x27126c(0x16f)),sql=require(a0_0x27126c(0x108)),passport=require(a0_0x27126c(0x1a5)),flash=require(a0_0x27126c(0x109)),session=require(a0_0x27126c(0x149)),methodOverride=require(a0_0x27126c(0x17e)),{authenticateRole}=require(a0_0x27126c(0xc5)),multer=require(a0_0x27126c(0xfa)),fs=require('fs');app[a0_0x27126c(0x12b)](express['json']()),app['use'](methodOverride('_method')),app['use'](express[a0_0x27126c(0xdd)]({'extended':![]}));const connectionString=a0_0x27126c(0x170);app[a0_0x27126c(0x12b)](flash()),app[a0_0x27126c(0x12b)](session({'secret':process[a0_0x27126c(0xe9)][a0_0x27126c(0x16c)],'resave':![],'saveUninitialized':![]}));const initalizePassport=require(a0_0x27126c(0x1ab)),{time}=require(a0_0x27126c(0x158));initalizePassport(passport,_0x1eec97=>{const _0x59e117=a0_0x27126c,_0x20926f=_0x59e117(0xc2);return new Promise((_0x5d90c8,_0x28ebe6)=>{const _0x556b38=_0x59e117;sql[_0x556b38(0x163)](connectionString,_0x20926f,[_0x1eec97,_0x1eec97,_0x1eec97],(_0x4dc2cf,_0x5cb4c3)=>{const _0x44e6f3=_0x556b38;if(_0x4dc2cf)return console[_0x44e6f3(0x1b2)](_0x44e6f3(0x15a),_0x4dc2cf),_0x28ebe6(new Error(_0x4dc2cf));_0x5cb4c3[_0x44e6f3(0xef)]>0x0?_0x5d90c8(_0x5cb4c3[0x0]):_0x5d90c8(null);});});},_0xc03357=>{const _0x52791c=a0_0x27126c,_0x5765fb=_0x52791c(0x121);return new Promise((_0x17d1d9,_0xebfa49)=>{sql['query'](connectionString,_0x5765fb,[_0xc03357],(_0x44789a,_0x534948)=>{const _0x4112e4=a0_0x2782;if(_0x44789a)return console[_0x4112e4(0x1b2)](_0x4112e4(0x15a),_0x44789a),_0xebfa49(new Error(_0x44789a));_0x534948[_0x4112e4(0xef)]>0x0?_0x17d1d9(_0x534948[0x0]):_0x17d1d9(null);});});}),app[a0_0x27126c(0x12b)](passport[a0_0x27126c(0xf0)]()),app[a0_0x27126c(0x12b)](passport['session']()),app['use'](methodOverride(a0_0x27126c(0x11e))),app[a0_0x27126c(0xf3)](a0_0x27126c(0x173),'ejs'),app[a0_0x27126c(0x12b)](a0_0x27126c(0x1b3),express['static'](path['join'](__dirname,a0_0x27126c(0x13d))));const uploadFolder=path[a0_0x27126c(0x12c)](__dirname,'uploads');!fs[a0_0x27126c(0x193)](uploadFolder)&&fs[a0_0x27126c(0x13e)](uploadFolder);const storage=multer[a0_0x27126c(0xf5)]({'destination':function(_0x39ed27,_0x358d1a,_0x1a4a72){_0x1a4a72(null,uploadFolder);},'filename':function(_0x308187,_0x3ba570,_0x5d8a48){const _0x425cc7=a0_0x27126c,_0x2012f8=Date['now']()+'-'+_0x3ba570[_0x425cc7(0x138)];_0x5d8a48(null,_0x2012f8);}}),upload=multer({'storage':storage});app[a0_0x27126c(0x14b)](a0_0x27126c(0xf6),checkAuthenticated,authenticateRole(['admin','teacher']),(_0x316c10,_0x86cfc0,_0x148160)=>{_0x148160();},upload['single'](a0_0x27126c(0xee)),(_0x5a88da,_0x2a8157)=>{const _0x51183b=a0_0x27126c,{course_id:_0x19df85}=_0x5a88da[_0x51183b(0x139)],_0x7f5100=_0x5a88da[_0x51183b(0x131)];if(!_0x19df85||!_0x7f5100)return _0x2a8157['status'](0x190)[_0x51183b(0x164)](_0x51183b(0x183));const _0x1c16c9=_0x51183b(0x103),_0x13792b=[_0x19df85,_0x7f5100[_0x51183b(0x138)],path[_0x51183b(0x12c)](_0x51183b(0x13d),_0x7f5100[_0x51183b(0x106)]),_0x7f5100[_0x51183b(0x151)]];sql[_0x51183b(0x163)](connectionString,_0x1c16c9,_0x13792b,_0x5e2791=>{const _0x50f001=_0x51183b;if(_0x5e2791)return console[_0x50f001(0x1b2)](_0x50f001(0xff),_0x5e2791),_0x2a8157[_0x50f001(0x112)](0x1f4)['send'](_0x50f001(0x15b));console[_0x50f001(0x177)](_0x50f001(0x144)),_0x2a8157[_0x50f001(0x164)](_0x50f001(0x19d));});}),app[a0_0x27126c(0x14b)](a0_0x27126c(0x1a3),checkNotAuthenticated,passport['authenticate'](a0_0x27126c(0x12f),{'successRedirect':'/','failureRedirect':a0_0x27126c(0x1a3),'failureFlash':!![]}));const mapRole={'subject1':a0_0x27126c(0x1a4),'subject2':a0_0x27126c(0xc8),'subject3':a0_0x27126c(0x16d)};app[a0_0x27126c(0x14b)](a0_0x27126c(0xe5),checkAuthenticated,authenticateRole([a0_0x27126c(0x16d),'teacher']),(_0x6cf62e,_0x3e14f6)=>{const _0xea703b=a0_0x27126c,{userId:_0x1abb00,message:_0x764feb}=_0x6cf62e[_0xea703b(0x139)],_0x25c09c=_0x6cf62e[_0xea703b(0x11f)]['role'];if(_0x25c09c!=='admin'&&_0x25c09c!==_0xea703b(0xc8))return _0x3e14f6[_0xea703b(0x112)](0x193)[_0xea703b(0x164)](_0xea703b(0xbb));if(!_0x1abb00||!_0x764feb)return _0x3e14f6[_0xea703b(0x112)](0x190)[_0xea703b(0x164)](_0xea703b(0x146));const _0x2a375e=_0xea703b(0xce);sql[_0xea703b(0x163)](connectionString,_0x2a375e,[_0x1abb00,_0x764feb],_0x522051=>{const _0x6d8210=_0xea703b;if(_0x522051)return console['error'](_0x6d8210(0x15d),_0x522051),_0x3e14f6[_0x6d8210(0x112)](0x1f4)[_0x6d8210(0x164)](_0x6d8210(0x15b));console[_0x6d8210(0x177)](_0x6d8210(0xe7),_0x1abb00),_0x3e14f6[_0x6d8210(0x112)](0xc9)[_0x6d8210(0x164)](_0x6d8210(0x17f));});}),app[a0_0x27126c(0x190)](a0_0x27126c(0x180),checkAuthenticated,authenticateRole([a0_0x27126c(0x16d),a0_0x27126c(0xc8)]),(_0x16d348,_0x3906ec)=>{const _0x2a81ff=a0_0x27126c,_0x2a08ce=_0x2a81ff(0xec);sql[_0x2a81ff(0x163)](connectionString,_0x2a08ce,(_0x583a96,_0x48d8a6)=>{const _0x17e857=_0x2a81ff;if(_0x583a96)return console[_0x17e857(0x1b2)](_0x17e857(0x1b1),_0x583a96),_0x3906ec[_0x17e857(0x112)](0x1f4)[_0x17e857(0x164)](_0x17e857(0xc6));_0x3906ec[_0x17e857(0x168)](_0x17e857(0xf4),{'materials':_0x48d8a6,'user':_0x16d348['user']});});}),app['get'](a0_0x27126c(0xd0),checkAuthenticated,authenticateRole(['admin',a0_0x27126c(0xc8)]),(_0xb61720,_0x52effe)=>{const _0x85001c=a0_0x27126c,_0x4c24b4=_0xb61720['params']['id'],_0x2ce1d7=_0x85001c(0x134);sql[_0x85001c(0x163)](connectionString,_0x2ce1d7,[_0x4c24b4],(_0x15fb4f,_0x2d5c98)=>{const _0x22cb72=_0x85001c;if(_0x15fb4f)return _0x52effe[_0x22cb72(0x112)](0x1f4)['send'](_0x22cb72(0xc6));if(_0x2d5c98[_0x22cb72(0xef)]===0x0)return _0x52effe[_0x22cb72(0x112)](0x194)['send'](_0x22cb72(0xeb));_0x52effe[_0x22cb72(0x168)]('editMaterial.ejs',{'material':_0x2d5c98[0x0],'user':_0xb61720['user']});});}),app['get']('/users',checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x58829e,_0x31062d)=>{const _0x313f53=a0_0x27126c,_0xda55c7=_0x313f53(0xdc);sql[_0x313f53(0x163)](connectionString,_0xda55c7,(_0x155805,_0x5271ff)=>{const _0x2e78c8=_0x313f53;if(_0x155805)return _0x31062d[_0x2e78c8(0x112)](0x1f4)['send']('Database\x20error');_0x31062d[_0x2e78c8(0x168)](_0x2e78c8(0x192),{'users':_0x5271ff});});}),app['get'](a0_0x27126c(0xe4),checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0xaf0ecc,_0xe2908e)=>{const _0x279b1a=a0_0x27126c,_0x3aefba=_0xaf0ecc[_0x279b1a(0x18a)]['id'],_0x30fb90=_0x279b1a(0x121);sql[_0x279b1a(0x163)](connectionString,_0x30fb90,[_0x3aefba],(_0x27d459,_0x43975a)=>{const _0x4f8fa6=_0x279b1a;if(_0x27d459||_0x43975a[_0x4f8fa6(0xef)]===0x0)return _0xe2908e['status'](0x1f4)[_0x4f8fa6(0x164)](_0x4f8fa6(0xde));_0xe2908e[_0x4f8fa6(0x168)](_0x4f8fa6(0xda),{'user':_0x43975a[0x0]});});}),app['get']('/',(_0x32acd2,_0x721d51)=>{const _0x5c6e56=a0_0x27126c;_0x721d51[_0x5c6e56(0x168)](_0x5c6e56(0x181),{'user':_0x32acd2[_0x5c6e56(0x11f)]});}),app['get'](a0_0x27126c(0x1a3),checkNotAuthenticated,(_0xc62151,_0x139852)=>{_0x139852['render']('login.ejs');}),app[a0_0x27126c(0x190)](a0_0x27126c(0x1a2),checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x4c1b2b,_0x3061ec)=>{const _0x5c97ce=a0_0x27126c;_0x3061ec[_0x5c97ce(0x168)](_0x5c97ce(0x15e));}),app[a0_0x27126c(0x190)]('/notifications',checkAuthenticated,(_0x370ec3,_0x158576)=>{const _0x4bb1ee=a0_0x27126c;_0x158576[_0x4bb1ee(0x168)](_0x4bb1ee(0x1a0),{'user':_0x370ec3[_0x4bb1ee(0x11f)]});}),app['get'](a0_0x27126c(0xcb),checkAuthenticated,authenticateRole('admin'),(_0x2a29ec,_0x5c6900)=>{const _0x1ff75d=a0_0x27126c;_0x5c6900[_0x1ff75d(0x168)](_0x1ff75d(0x153));}),app[a0_0x27126c(0x190)](a0_0x27126c(0x143),checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x104106,_0x42fc5d)=>{const _0x28b245=a0_0x27126c,_0x7a8612=_0x28b245(0x172);sql[_0x28b245(0x163)](connectionString,_0x7a8612,(_0x31811b,_0x1bc143)=>{const _0x3a37c1=_0x28b245;if(_0x31811b)return console['error']('Fetch\x20courses\x20error:',_0x31811b),_0x42fc5d[_0x3a37c1(0x112)](0x1f4)[_0x3a37c1(0x164)](_0x3a37c1(0xc6));_0x42fc5d[_0x3a37c1(0x168)](_0x3a37c1(0x119),{'courses':_0x1bc143,'user':_0x104106[_0x3a37c1(0x11f)]});});}),app[a0_0x27126c(0x190)](a0_0x27126c(0xd8),checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x46611,_0x1d9909)=>{const _0x5cddf3=a0_0x27126c,_0x1ee3ff=_0x46611['params']['id'],_0x3f6174=_0x5cddf3(0x115);sql[_0x5cddf3(0x163)](connectionString,_0x3f6174,[_0x1ee3ff],(_0x44507c,_0x388d34)=>{const _0xf1b51e=_0x5cddf3;if(_0x44507c)return console['error']('Edit\x20fetch\x20error:',_0x44507c),_0x1d9909[_0xf1b51e(0x112)](0x1f4)[_0xf1b51e(0x164)](_0xf1b51e(0xc6));if(_0x388d34[_0xf1b51e(0xef)]===0x0)return _0x1d9909[_0xf1b51e(0x112)](0x194)[_0xf1b51e(0x164)](_0xf1b51e(0x123));_0x1d9909['render'](_0xf1b51e(0x16a),{'course':_0x388d34[0x0]});});}),app[a0_0x27126c(0x190)](a0_0x27126c(0x19b),checkAuthenticated,(_0x4cfd29,_0x436982)=>{const _0x5f1052=a0_0x27126c;let _0x731fe0;if(_0x4cfd29[_0x5f1052(0x163)][_0x5f1052(0x117)])_0x731fe0=new Date(_0x4cfd29[_0x5f1052(0x163)]['weekStart']);else{const _0x271439=new Date(),_0x59b07c=(_0x271439[_0x5f1052(0xbf)]()+0x6)%0x7;_0x731fe0=new Date(_0x271439),_0x731fe0[_0x5f1052(0x133)](_0x271439[_0x5f1052(0x175)]()-_0x59b07c);}const _0x9301b5=_0xfdb0ae=>_0xfdb0ae[_0x5f1052(0xbe)]('vi-VN',{'day':'2-digit','month':_0x5f1052(0x11b),'year':_0x5f1052(0xd7)}),_0x22b32c=['Thứ\x202',_0x5f1052(0x148),_0x5f1052(0x165),_0x5f1052(0x1ad),_0x5f1052(0x19e),_0x5f1052(0x10f),_0x5f1052(0x160)],_0x1af1d1=Array['from']({'length':0x7},(_0x5abc4f,_0x44a885)=>{const _0x3ce1fa=_0x5f1052,_0x32113e=new Date(_0x731fe0);return _0x32113e[_0x3ce1fa(0x133)](_0x731fe0['getDate']()+_0x44a885),{'name':_0x22b32c[_0x44a885],'date':_0x9301b5(_0x32113e),'iso':_0x32113e[_0x3ce1fa(0x14c)]()['slice'](0x0,0xa)};}),_0xda548=Array[_0x5f1052(0x19f)]({'length':0xf},(_0x371220,_0x43e108)=>_0x5f1052(0x185)+(_0x43e108+0x1)),_0x415e9d=_0x4cfd29['user']['id'],_0x25e776=_0x4cfd29['user'][_0x5f1052(0x171)],_0x9ce6f=_0x1af1d1[0x0][_0x5f1052(0x152)],_0x252ef9=_0x1af1d1[0x6][_0x5f1052(0x152)];let _0x32e259,_0x13d1df;if(_0x25e776===_0x5f1052(0x1a4))_0x32e259=_0x5f1052(0x142),_0x13d1df=[_0x415e9d,_0x9ce6f,_0x252ef9];else{if(_0x25e776==='teacher')_0x32e259=_0x5f1052(0x17d),_0x13d1df=[_0x415e9d,_0x9ce6f,_0x252ef9];else return _0x436982['status'](0x193)[_0x5f1052(0x164)](_0x5f1052(0x13b));}console[_0x5f1052(0x177)](_0x5f1052(0xf9),_0x25e776,_0x5f1052(0x145),_0x415e9d),console[_0x5f1052(0x177)](_0x5f1052(0xd1),_0x9ce6f,'→',_0x252ef9),sql['query'](connectionString,_0x32e259,_0x13d1df,(_0x1e0386,_0x65497d)=>{const _0x9c70bd=_0x5f1052;if(_0x1e0386)return console['error']('SQL\x20Error:',_0x1e0386),_0x436982['status'](0x1f4)[_0x9c70bd(0x164)](_0x9c70bd(0xc6));const _0x174e32={'07:00:00':0x0,'08:00:00':0x1,'09:00:00':0x2,'10:00:00':0x3,'11:00:00':0x4,'12:00:00':0x5,'13:00:00':0x6,'14:00:00':0x7,'15:00:00':0x8,'16:00:00':0x9,'17:00:00':0xa,'18:00:00':0xb,'19:00:00':0xc,'20:00:00':0xd,'21:00:00':0xe},_0xbff684=_0x65497d['map'](_0x4fd39a=>{const _0x298fe6=_0x9c70bd,_0x2606eb=_0x4fd39a[_0x298fe6(0x195)]['toISOString']()[_0x298fe6(0xfc)](0x0,0xa),_0xd88bdb=_0x4fd39a[_0x298fe6(0x17c)][_0x298fe6(0x14c)]()[_0x298fe6(0xfc)](0xb,0x13),_0x468633=_0x174e32[_0xd88bdb];return{'time':_0xd88bdb,'date':_0x2606eb,'periodIndex':_0x468633,'className':_0x4fd39a['class_name'],'teacher':_0x4fd39a[_0x298fe6(0xc8)]||''};});console['log'](_0x9c70bd(0xf7),_0xbff684);const _0x17ffc0=_0xbff684[_0x9c70bd(0xef)]?Math[_0x9c70bd(0xd4)](..._0xbff684['map'](_0x5ead1b=>_0x5ead1b['periodIndex'])):0x0,_0x53933b=new Date(_0x731fe0);_0x53933b[_0x9c70bd(0x133)](_0x53933b[_0x9c70bd(0x175)]()-0x7);const _0x4fe6fc=new Date(_0x731fe0);_0x4fe6fc[_0x9c70bd(0x133)](_0x4fe6fc[_0x9c70bd(0x175)]()+0x7),_0x436982['render'](_0x9c70bd(0xc3),{'user':_0x4cfd29[_0x9c70bd(0x11f)],'days':_0x1af1d1,'periods':_0xda548,'scheduleData':_0xbff684,'weekStart':_0x731fe0[_0x9c70bd(0x14c)]()[_0x9c70bd(0xfc)](0x0,0xa),'prevWeekStart':_0x53933b[_0x9c70bd(0x14c)]()[_0x9c70bd(0xfc)](0x0,0xa),'nextWeekStart':_0x4fe6fc[_0x9c70bd(0x14c)]()[_0x9c70bd(0xfc)](0x0,0xa),'maxPeriod':_0x17ffc0});});}),app[a0_0x27126c(0x190)](a0_0x27126c(0x18f),checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x2975ef,_0x4da325)=>{const _0xe7652e=a0_0x27126c,_0x514709=_0xe7652e(0x114);sql[_0xe7652e(0x163)](connectionString,_0x514709,(_0xf9bf1c,_0x544889)=>{const _0x348dc7=_0xe7652e;if(_0xf9bf1c)return _0x4da325[_0x348dc7(0x112)](0x1f4)[_0x348dc7(0x164)](_0x348dc7(0x166));_0x4da325[_0x348dc7(0x168)](_0x348dc7(0x12d),{'classes':_0x544889,'user':_0x2975ef[_0x348dc7(0x11f)]});});}),app[a0_0x27126c(0x190)](a0_0x27126c(0x12a),checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x962c42,_0x14f091)=>{const _0x1d550e='\x0a\x20\x20\x20\x20SELECT\x20s.*,\x20c.class_name\x0a\x20\x20\x20\x20FROM\x20schedules\x20s\x0a\x20\x20\x20\x20JOIN\x20classes\x20c\x20ON\x20s.class_id\x20=\x20c.id\x0a\x20\x20\x20\x20ORDER\x20BY\x20s.schedule_date\x20DESC\x0a\x20\x20';sql['query'](connectionString,_0x1d550e,(_0x2f906d,_0x19ee09)=>{const _0x35597e=a0_0x2782;if(_0x2f906d)return console[_0x35597e(0x1b2)](_0x35597e(0x10b),_0x2f906d),_0x14f091['status'](0x1f4)[_0x35597e(0x164)](_0x35597e(0xc6));_0x14f091[_0x35597e(0x168)](_0x35597e(0xc1),{'schedules':_0x19ee09,'user':_0x962c42['user']});});}),app[a0_0x27126c(0x190)](a0_0x27126c(0xea),checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x43dbfa,_0x59721e)=>{const _0x1b6682=a0_0x27126c,_0xc81202=_0x43dbfa[_0x1b6682(0x18a)]['id'],_0x482a48=_0x1b6682(0xc7),_0x4cf736=_0x1b6682(0x114);sql['query'](connectionString,_0x482a48,[_0xc81202],(_0x372e81,_0x8d3d2b)=>{const _0x3419c5=_0x1b6682;if(_0x372e81||_0x8d3d2b[_0x3419c5(0xef)]===0x0)return _0x59721e[_0x3419c5(0x112)](0x1f4)[_0x3419c5(0x164)](_0x3419c5(0xfb));sql[_0x3419c5(0x163)](connectionString,_0x4cf736,(_0x3a009d,_0x26fc9d)=>{const _0x55e1f4=_0x3419c5;if(_0x3a009d)return _0x59721e[_0x55e1f4(0x112)](0x1f4)[_0x55e1f4(0x164)](_0x55e1f4(0x166));_0x59721e[_0x55e1f4(0x168)](_0x55e1f4(0xd2),{'schedule':_0x8d3d2b[0x0],'classes':_0x26fc9d,'user':_0x43dbfa['user']});});});}),app[a0_0x27126c(0x14b)](a0_0x27126c(0x157),checkAuthenticated,authenticateRole(['admin','teacher']),(_0x24598e,_0x506bd9)=>{const _0x2d5521=a0_0x27126c,{class_name:_0x2f6812,course_id:_0xc58609,teacher_id:_0x5a3c61,start_time:_0x59869a,end_time:_0xe44cce}=_0x24598e[_0x2d5521(0x139)];if(!_0x2f6812||!_0xc58609||!_0x5a3c61||!_0x59869a||!_0xe44cce)return _0x506bd9[_0x2d5521(0x112)](0x190)[_0x2d5521(0x164)](_0x2d5521(0x14a));const _0x655aca=_0x2d5521(0xfd);sql[_0x2d5521(0x163)](connectionString,_0x655aca,[_0x2f6812,_0xc58609,_0x5a3c61,_0x59869a,_0xe44cce],_0x57f870=>{const _0x36d84b=_0x2d5521;if(_0x57f870)return console[_0x36d84b(0x1b2)]('Insert\x20class\x20error:',_0x57f870),_0x506bd9['status'](0x1f4)['send'](_0x36d84b(0xc6));_0x506bd9[_0x36d84b(0x17b)]('/classes');});}),app['get'](a0_0x27126c(0x157),checkAuthenticated,authenticateRole([a0_0x27126c(0x16d),a0_0x27126c(0xc8)]),(_0x46847a,_0x3b01df)=>{const _0x486265=a0_0x27126c,_0x134024=_0x486265(0x186);sql[_0x486265(0x163)](connectionString,_0x134024,(_0x141db0,_0x404fab)=>{const _0x8efdc6=_0x486265;if(_0x141db0)return console['error'](_0x8efdc6(0x1ae),_0x141db0),_0x3b01df[_0x8efdc6(0x112)](0x1f4)[_0x8efdc6(0x164)](_0x8efdc6(0xc6));_0x3b01df[_0x8efdc6(0x168)](_0x8efdc6(0x13c),{'classes':_0x404fab,'user':_0x46847a[_0x8efdc6(0x11f)]});});}),app['get'](a0_0x27126c(0x198),checkAuthenticated,authenticateRole([a0_0x27126c(0x16d),'teacher']),(_0x39ad13,_0x2d8614)=>{const _0x1a2d13=a0_0x27126c,_0xa5875d=_0x39ad13[_0x1a2d13(0x18a)]['id'],_0x28bb1d=_0x1a2d13(0x14e),_0x339c1d=_0x1a2d13(0x111),_0x199b3f=_0x1a2d13(0x162);sql[_0x1a2d13(0x163)](connectionString,_0x28bb1d,[_0xa5875d],(_0xba45a2,_0x52e207)=>{const _0x5aad96=_0x1a2d13;if(_0xba45a2||_0x52e207[_0x5aad96(0xef)]===0x0)return _0x2d8614[_0x5aad96(0x112)](0x1f4)[_0x5aad96(0x164)]('Class\x20not\x20found');sql['query'](connectionString,_0x339c1d,(_0x3b7ec6,_0x5dc324)=>{const _0x4e1698=_0x5aad96;if(_0x3b7ec6)return _0x2d8614[_0x4e1698(0x112)](0x1f4)[_0x4e1698(0x164)]('Course\x20fetch\x20error');sql[_0x4e1698(0x163)](connectionString,_0x199b3f,(_0x5de9c3,_0x42cab4)=>{const _0x121a3a=_0x4e1698;if(_0x5de9c3)return _0x2d8614[_0x121a3a(0x112)](0x1f4)[_0x121a3a(0x164)](_0x121a3a(0x1a6));_0x2d8614[_0x121a3a(0x168)](_0x121a3a(0xe3),{'classItem':_0x52e207[0x0],'courses':_0x5dc324,'teachers':_0x42cab4,'user':_0x39ad13[_0x121a3a(0x11f)]});});});});}),app[a0_0x27126c(0x190)](a0_0x27126c(0x10e),checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0xf32ea3,_0x143d87)=>{const _0x509964=a0_0x27126c,_0x5af1e5=_0x509964(0x15c);sql[_0x509964(0x163)](connectionString,_0x5af1e5,(_0x59240e,_0x4711c4)=>{const _0x1a239d=_0x509964;if(_0x59240e)return console[_0x1a239d(0x1b2)](_0x1a239d(0x14d),_0x59240e),_0x143d87[_0x1a239d(0x112)](0x1f4)[_0x1a239d(0x164)](_0x1a239d(0xc6));_0x143d87[_0x1a239d(0x168)](_0x1a239d(0xf1),{'enrollments':_0x4711c4,'user':_0xf32ea3[_0x1a239d(0x11f)]});});}),app[a0_0x27126c(0x190)]('/enrollments/:id/edit',checkAuthenticated,authenticateRole('admin'),(_0x3cf29a,_0x4d38c4)=>{const _0x1fe01c=a0_0x27126c,_0x51c5ef=_0x3cf29a[_0x1fe01c(0x18a)]['id'],_0x3ab673=_0x1fe01c(0x187),_0x337da4=_0x1fe01c(0x10d),_0x5a42a5=_0x1fe01c(0x114);sql[_0x1fe01c(0x163)](connectionString,_0x3ab673,[_0x51c5ef],(_0x29d4c4,_0x111831)=>{const _0x1030e3=_0x1fe01c;if(_0x29d4c4||_0x111831['length']===0x0)return _0x4d38c4[_0x1030e3(0x112)](0x194)[_0x1030e3(0x164)](_0x1030e3(0xcf));const _0x10b235=_0x111831[0x0];sql[_0x1030e3(0x163)](connectionString,_0x337da4,(_0x1fef7d,_0x52a1eb)=>{const _0x16aa00=_0x1030e3;if(_0x1fef7d)return _0x4d38c4['status'](0x1f4)[_0x16aa00(0x164)]('Students\x20fetch\x20error');sql[_0x16aa00(0x163)](connectionString,_0x5a42a5,(_0x508e04,_0x5b377e)=>{const _0x586ad8=_0x16aa00;if(_0x508e04)return _0x4d38c4['status'](0x1f4)[_0x586ad8(0x164)](_0x586ad8(0x189));_0x4d38c4[_0x586ad8(0x168)](_0x586ad8(0x1a8),{'enrollment':_0x10b235,'students':_0x52a1eb,'classes':_0x5b377e,'user':_0x3cf29a[_0x586ad8(0x11f)]});});});});}),app[a0_0x27126c(0x190)]('/payments',checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x18bf8b,_0x3b1ef4)=>{const _0x1397fc=a0_0x27126c,_0xd87b4b='\x0a\x20\x20\x20\x20SELECT\x20p.id,\x20s.full_name\x20AS\x20student_name,\x20p.amount,\x20p.payment_date\x0a\x20\x20\x20\x20FROM\x20payments\x20p\x0a\x20\x20\x20\x20JOIN\x20students\x20s\x20ON\x20p.student_id\x20=\x20s.id\x0a\x20\x20\x20\x20ORDER\x20BY\x20p.payment_date\x20DESC\x0a\x20\x20';sql[_0x1397fc(0x163)](connectionString,_0xd87b4b,(_0x530075,_0x18e184)=>{const _0x392a49=_0x1397fc;if(_0x530075)return console[_0x392a49(0x1b2)](_0x392a49(0x127),_0x530075),_0x3b1ef4[_0x392a49(0x112)](0x1f4)[_0x392a49(0x164)](_0x392a49(0xc6));_0x3b1ef4['render'](_0x392a49(0x14f),{'payments':_0x18e184,'user':_0x18bf8b[_0x392a49(0x11f)]});});}),app[a0_0x27126c(0x190)](a0_0x27126c(0xbd),checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x2930ed,_0x451994)=>{const _0x3db2d1=a0_0x27126c,_0x373a7a=_0x2930ed[_0x3db2d1(0x18a)]['id'],_0x1eed82=_0x3db2d1(0x13a),_0x4226c2='SELECT\x20id,\x20full_name\x20FROM\x20students';sql[_0x3db2d1(0x163)](connectionString,_0x1eed82,[_0x373a7a],(_0x404ff1,_0x5a89ff)=>{const _0x4844fe=_0x3db2d1;if(_0x404ff1||_0x5a89ff[_0x4844fe(0xef)]===0x0)return _0x451994[_0x4844fe(0x112)](0x194)[_0x4844fe(0x164)](_0x4844fe(0xfe));const _0x3cf827=_0x5a89ff[0x0];sql[_0x4844fe(0x163)](connectionString,_0x4226c2,(_0x417255,_0xa0558e)=>{const _0x3c4eb2=_0x4844fe;if(_0x417255)return _0x451994[_0x3c4eb2(0x112)](0x1f4)[_0x3c4eb2(0x164)](_0x3c4eb2(0x125));_0x451994[_0x3c4eb2(0x168)](_0x3c4eb2(0x18b),{'payment':_0x3cf827,'students':_0xa0558e,'user':_0x2930ed[_0x3c4eb2(0x11f)]});});});}),app[a0_0x27126c(0x190)](a0_0x27126c(0xd3),checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x446083,_0x370e2c)=>{const _0x5b4430=a0_0x27126c;_0x370e2c['render'](_0x5b4430(0x130),{'user':_0x446083[_0x5b4430(0x11f)]});}),app[a0_0x27126c(0x190)]('/enrollments/new',checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x157812,_0x259aa3)=>{const _0x4f6594=a0_0x27126c;_0x259aa3[_0x4f6594(0x168)](_0x4f6594(0xc0),{'user':_0x157812[_0x4f6594(0x11f)]});}),app[a0_0x27126c(0x190)](a0_0x27126c(0x11d),authenticateRole([a0_0x27126c(0x16d),a0_0x27126c(0xc8)]),checkAuthenticated,(_0x25277c,_0x20f478)=>{const _0x1167fd=a0_0x27126c;_0x20f478['render'](_0x1167fd(0xbc));}),app[a0_0x27126c(0x190)](a0_0x27126c(0x157),checkAuthenticated,authenticateRole([a0_0x27126c(0x16d),a0_0x27126c(0xc8)]),(_0x566a04,_0x253042)=>{const _0x657803=a0_0x27126c;_0x253042[_0x657803(0x168)](_0x657803(0x179),{'user':_0x566a04['user']});}),app[a0_0x27126c(0x14b)](a0_0x27126c(0x1a9),checkAuthenticated,authenticateRole([a0_0x27126c(0x16d),'teacher']),(_0x382114,_0x2e7c8b)=>{const _0x398833=a0_0x27126c,{course_id:_0x11fabd,file_name:_0x20dfe3}=_0x382114['body'],_0xe91f84='\x0a\x20\x20\x20\x20UPDATE\x20materials\x0a\x20\x20\x20\x20SET\x20course_id\x20=\x20?,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20file_name\x20=\x20?,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20uploaded_at\x20=\x20GETDATE()\x0a\x20\x20\x20\x20WHERE\x20id\x20=\x20?\x0a\x20\x20';sql[_0x398833(0x163)](connectionString,_0xe91f84,[_0x11fabd,_0x20dfe3,_0x382114[_0x398833(0x18a)]['id']],_0x590fae=>{const _0x2067b2=_0x398833;if(_0x590fae)return console[_0x2067b2(0x1b2)](_0x2067b2(0x118),_0x590fae),_0x2e7c8b['status'](0x1f4)[_0x2067b2(0x164)](_0x2067b2(0xc6));_0x2e7c8b[_0x2067b2(0x17b)](_0x2067b2(0x180));});}),app[a0_0x27126c(0x176)](a0_0x27126c(0x1a9),checkAuthenticated,authenticateRole([a0_0x27126c(0x16d),a0_0x27126c(0xc8)]),(_0x1e92dd,_0x51ea61)=>{const _0x427f7e=a0_0x27126c,_0x387f89=_0x1e92dd[_0x427f7e(0x18a)]['id'],_0x249134=_0x427f7e(0x126);sql[_0x427f7e(0x163)](connectionString,_0x249134,[_0x387f89],(_0x2f08c7,_0x50f089)=>{const _0x6e649d=_0x427f7e;if(_0x2f08c7||_0x50f089[_0x6e649d(0xef)]===0x0)return _0x51ea61['status'](0x1f4)[_0x6e649d(0x164)](_0x6e649d(0x194));const _0x1a26b7=path[_0x6e649d(0x12c)](__dirname,_0x50f089[0x0][_0x6e649d(0x178)]),_0x21ffd0=_0x6e649d(0x140);sql[_0x6e649d(0x163)](connectionString,_0x21ffd0,[_0x387f89],_0x4dc522=>{const _0x1f7f63=_0x6e649d;if(_0x4dc522)return _0x51ea61['status'](0x1f4)[_0x1f7f63(0x164)](_0x1f7f63(0x1aa));fs[_0x1f7f63(0xf8)](_0x1a26b7,_0x53dd2c=>{const _0x1a08d7=_0x1f7f63;if(_0x53dd2c)console['error'](_0x1a08d7(0x174),_0x53dd2c);_0x51ea61['redirect'](_0x1a08d7(0x180));});});});}),app['post'](a0_0x27126c(0x143),checkAuthenticated,authenticateRole('admin'),(_0x4976ef,_0x5f582c)=>{const _0x156c1f=a0_0x27126c,{course_name:_0x50dfe7,description:_0x44073f,start_date:_0x4e064d,end_date:_0x53bd05}=_0x4976ef[_0x156c1f(0x139)],_0x1c076b=_0x4976ef[_0x156c1f(0x11f)][_0x156c1f(0x171)];if(_0x1c076b!==_0x156c1f(0x16d)&&_0x1c076b!=='teacher')return _0x5f582c[_0x156c1f(0x112)](0x193)['send'](_0x156c1f(0x136));if(!_0x50dfe7||!_0x4e064d||!_0x53bd05)return _0x5f582c[_0x156c1f(0x112)](0x190)[_0x156c1f(0x164)](_0x156c1f(0x14a));const _0x740347=_0x156c1f(0x107);sql[_0x156c1f(0x163)](connectionString,_0x740347,[_0x50dfe7,_0x44073f,_0x4e064d,_0x53bd05],(_0x4fcfb1,_0x3e5744)=>{const _0x94e26=_0x156c1f;if(_0x4fcfb1)return console['error'](_0x94e26(0x110),_0x4fcfb1),_0x5f582c[_0x94e26(0x112)](0x1f4)[_0x94e26(0x164)](_0x94e26(0xc6));console[_0x94e26(0x177)](_0x94e26(0x18c),_0x3e5744),_0x5f582c['redirect']('/courses');});}),app[a0_0x27126c(0x14b)]('/register',checkNotAuthenticated,authenticateRole(a0_0x27126c(0x16d)),async(_0x47f506,_0x3914a1)=>{const _0x387e9a=a0_0x27126c;try{const _0x2c81f3=await bcrypt[_0x387e9a(0xed)](_0x47f506[_0x387e9a(0x139)][_0x387e9a(0x161)],0xa),_0x3a5975=_0x47f506['body']['Name'],_0x193c19=_0x47f506[_0x387e9a(0x139)]['email'],_0x20c07d=_0x47f506[_0x387e9a(0x139)][_0x387e9a(0x159)],_0x44d647=_0x47f506['body']['phone'],_0x138e07=_0x47f506[_0x387e9a(0x139)]['Address'],_0xc099d0=_0x47f506[_0x387e9a(0x139)][_0x387e9a(0x1a1)],_0x419f10=_0x47f506['body']['salary'],_0x36f406=mapRole[_0xc099d0];if(!_0x3a5975)return _0x3914a1[_0x387e9a(0x112)](0x190)['send'](_0x387e9a(0x156));if(!_0x193c19)return _0x3914a1[_0x387e9a(0x112)](0x190)[_0x387e9a(0x164)](_0x387e9a(0x105));if(!_0x44d647)return _0x3914a1[_0x387e9a(0x112)](0x190)[_0x387e9a(0x164)]('Phone\x20number\x20is\x20required');if(!_0x138e07)return _0x3914a1['status'](0x190)['send'](_0x387e9a(0x191));if(!_0x20c07d)return _0x3914a1[_0x387e9a(0x112)](0x190)[_0x387e9a(0x164)](_0x387e9a(0x197));if(_0x36f406===_0x387e9a(0xc8)&&!_0x419f10)return _0x3914a1[_0x387e9a(0x112)](0x190)['send'](_0x387e9a(0xd6));if(_0x36f406===_0x387e9a(0x1a4)){const _0x365926='INSERT\x20INTO\x20users\x20(username,\x20password,\x20role,\x20created_at,\x20updated_at)\x20VALUES\x20(?,\x20?,\x20?,\x20GETDATE(),\x20GETDATE());\x0a\x20\x20\x20\x20\x20\x20\x20INSERT\x20INTO\x20students\x20(user_id,\x20full_name,\x20email,\x20phone_number,\x20address,\x20date_of_birth,\x20created_at,\x20updated_at)\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20id,\x20?,\x20?,\x20?,\x20?,\x20?,\x20GETDATE(),\x20GETDATE()\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20users\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20username\x20=\x20?;\x0a\x20\x20\x20\x20\x20\x20',_0x5ee967=[_0x3a5975,_0x2c81f3,_0x36f406,_0x3a5975,_0x193c19,_0x44d647,_0x138e07,_0x20c07d,_0x3a5975];sql[_0x387e9a(0x163)](connectionString,_0x365926,_0x5ee967,(_0x271669,_0x1cd68f)=>{const _0x3f5bc5=_0x387e9a;if(_0x271669)return console[_0x3f5bc5(0x1b2)](_0x3f5bc5(0x13f),_0x271669),_0x3914a1[_0x3f5bc5(0x112)](0x1f4)[_0x3f5bc5(0x164)](_0x3f5bc5(0x15b));console[_0x3f5bc5(0x177)]('User\x20registered:',_0x1cd68f);});}else{if(_0x36f406===_0x387e9a(0xc8)){const _0x37e496=_0x387e9a(0xe0),_0x5eec33=[_0x3a5975,_0x2c81f3,_0x36f406,_0x3a5975,_0x193c19,_0x44d647,_0x138e07,_0x20c07d,_0x419f10,_0x3a5975];sql[_0x387e9a(0x163)](connectionString,_0x37e496,_0x5eec33,(_0x2d35c9,_0x433995)=>{const _0x42c886=_0x387e9a;if(_0x2d35c9)return console[_0x42c886(0x1b2)](_0x42c886(0x13f),_0x2d35c9),_0x3914a1[_0x42c886(0x112)](0x1f4)['send']('Database\x20insert\x20error');});}else{if(_0x36f406===_0x387e9a(0x16d)){const _0x37fa7c=_0x387e9a(0xcc),_0x348040=[_0x3a5975,_0x2c81f3,_0x36f406,_0x3a5975,_0x193c19,_0x44d647,_0x3a5975];sql['query'](connectionString,_0x37fa7c,_0x348040,(_0x46a259,_0x3ad1a7)=>{const _0x3809c0=_0x387e9a;try{if(_0x46a259)return console[_0x3809c0(0x1b2)](_0x3809c0(0x13f),_0x46a259),_0x3914a1[_0x3809c0(0x112)](0x1f4)[_0x3809c0(0x164)](_0x3809c0(0x15b));console[_0x3809c0(0x177)]('Admin\x20registered:',_0x3ad1a7),_0x3914a1[_0x3809c0(0x17b)](_0x3809c0(0x1a3));}catch(_0x23e41b){_0x23e41b[_0x3809c0(0x18d)]!==_0x3809c0(0x135)&&console[_0x3809c0(0x1b2)](_0x3809c0(0x17a),_0x23e41b);}});}}}}catch(_0x43183d){console[_0x387e9a(0x1b2)](_0x387e9a(0x124),_0x43183d),_0x3914a1['redirect'](_0x387e9a(0x1a2));}}),app[a0_0x27126c(0x14b)](a0_0x27126c(0xc4),checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x8b6b64,_0x2b7a2d)=>{const _0x392bc4=a0_0x27126c,{username:_0x179d0c,role:_0xe3ee2c}=_0x8b6b64['body'],_0x585e57=_0x392bc4(0x122);sql['query'](connectionString,_0x585e57,[_0x179d0c,_0xe3ee2c,_0x8b6b64[_0x392bc4(0x18a)]['id']],_0x40eb05=>{const _0x553d9c=_0x392bc4;try{if(_0x40eb05)return console[_0x553d9c(0x1b2)](_0x553d9c(0x120),_0x40eb05),_0x2b7a2d[_0x553d9c(0x112)](0x1f4)[_0x553d9c(0x164)](_0x553d9c(0x10a));_0x2b7a2d[_0x553d9c(0x17b)]('/users');}catch(_0x52e985){_0x52e985[_0x553d9c(0x18d)]!=='ERR_HTTP_HEADERS_SENT'&&console['error'](_0x553d9c(0x17a),_0x52e985);}});}),app['delete'](a0_0x27126c(0xc4),checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x1c468d,_0x23cf74)=>{const _0x493554=a0_0x27126c,_0x46b93b=_0x493554(0x15f);sql[_0x493554(0x163)](connectionString,_0x46b93b,[_0x1c468d[_0x493554(0x18a)]['id']],_0x572cbd=>{const _0x5d7d45=_0x493554;if(_0x572cbd)return _0x23cf74[_0x5d7d45(0x112)](0x1f4)[_0x5d7d45(0x164)](_0x5d7d45(0x104));_0x23cf74[_0x5d7d45(0x17b)]('/users');});}),app[a0_0x27126c(0x14b)]('/courses/:id',checkAuthenticated,authenticateRole('admin'),(_0x2d5bfd,_0x25bf4b)=>{const _0x462f16=a0_0x27126c,{course_name:_0x2bc9a3,description:_0x374388,start_date:_0x46387c,end_date:_0x20c1c6}=_0x2d5bfd['body'],_0x28c713=_0x2d5bfd['user'][_0x462f16(0x171)];if(_0x28c713!==_0x462f16(0x16d)&&_0x28c713!==_0x462f16(0xc8))return _0x25bf4b['status'](0x193)[_0x462f16(0x164)](_0x462f16(0x136));if(!_0x2bc9a3||!_0x46387c||!_0x20c1c6)return _0x25bf4b[_0x462f16(0x112)](0x190)[_0x462f16(0x164)](_0x462f16(0x14a));const _0x1155d9=_0x462f16(0x169),_0x1d62c2=[_0x2bc9a3,_0x374388,_0x46387c,_0x20c1c6,_0x2d5bfd[_0x462f16(0x18a)]['id']];sql[_0x462f16(0x163)](connectionString,_0x1155d9,_0x1d62c2,(_0x28ee79,_0x2769c6)=>{const _0x396189=_0x462f16;try{try{if(_0x28ee79)return console['error']('Update\x20error:',_0x28ee79),_0x25bf4b[_0x396189(0x112)](0x1f4)['send']('Update\x20failed');if(!_0x2769c6||_0x2769c6[_0x396189(0x10c)]===0x0)return _0x25bf4b[_0x396189(0x112)](0x194)[_0x396189(0x164)]('Course\x20not\x20found');_0x25bf4b[_0x396189(0x17b)]('/courses');}catch(_0x235aa7){_0x235aa7[_0x396189(0x18d)]!==_0x396189(0x135)&&console[_0x396189(0x1b2)](_0x396189(0x17a),_0x235aa7);}}catch(_0x44be92){_0x44be92[_0x396189(0x18d)]!=='ERR_HTTP_HEADERS_SENT'&&console['error']('Unhandled\x20error:',_0x44be92);}});}),app[a0_0x27126c(0x176)](a0_0x27126c(0x154),checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x4be993,_0x5988e1)=>{const _0x1bf3a9=a0_0x27126c,_0x1a759c=_0x1bf3a9(0x19c);sql['query'](connectionString,_0x1a759c,[_0x4be993[_0x1bf3a9(0x18a)]['id']],_0x446d25=>{const _0x19dc47=_0x1bf3a9;if(_0x446d25)return console['error'](_0x19dc47(0xe1),_0x446d25),_0x5988e1[_0x19dc47(0x112)](0x1f4)[_0x19dc47(0x164)](_0x19dc47(0x104));_0x5988e1['redirect']('/courses');});}),app['use'](express['static'](path[a0_0x27126c(0x12c)](__dirname,'public'))),app['delete'](a0_0x27126c(0xca),(_0xeeec7f,_0x458b58)=>{const _0x5862dd=a0_0x27126c;_0xeeec7f[_0x5862dd(0x141)](_0x34f363=>{const _0x26f26e=_0x5862dd;if(_0x34f363)return console[_0x26f26e(0x1b2)]('Error\x20during\x20logout:',_0x34f363),_0x458b58['status'](0x1f4)[_0x26f26e(0x164)](_0x26f26e(0x116));_0x458b58[_0x26f26e(0x17b)](_0x26f26e(0x1a3));});}),app[a0_0x27126c(0x14b)](a0_0x27126c(0xf6),checkAuthenticated,authenticateRole([a0_0x27126c(0x16d),a0_0x27126c(0xc8)]),upload[a0_0x27126c(0x182)](a0_0x27126c(0xee)),(_0x25bdad,_0x39e20e)=>{const _0x1a9178=a0_0x27126c,{course_id:_0x4eee02}=_0x25bdad[_0x1a9178(0x139)],_0x3fc666=_0x25bdad[_0x1a9178(0x131)];if(!_0x4eee02||!_0x3fc666)return _0x39e20e['status'](0x190)[_0x1a9178(0x164)]('Missing\x20course_id\x20or\x20file.');const _0x392e1b='\x0a\x20\x20\x20\x20INSERT\x20INTO\x20materials\x20(course_id,\x20file_name,\x20file_path,\x20mime_type)\x0a\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?)\x0a\x20\x20',_0x508773=[_0x4eee02,_0x3fc666[_0x1a9178(0x138)],path[_0x1a9178(0x12c)](_0x1a9178(0x13d),_0x3fc666['filename']),_0x3fc666[_0x1a9178(0x151)]];sql[_0x1a9178(0x163)](connectionString,_0x392e1b,_0x508773,_0x17d471=>{const _0xab22bd=_0x1a9178;if(_0x17d471)return console[_0xab22bd(0x1b2)](_0xab22bd(0xff),_0x17d471),_0x39e20e[_0xab22bd(0x112)](0x1f4)['send'](_0xab22bd(0x15b));console[_0xab22bd(0x177)](_0xab22bd(0x144)),_0x39e20e[_0xab22bd(0x164)]('File\x20uploaded\x20and\x20saved\x20to\x20database.');});}),app[a0_0x27126c(0x14b)]('/schedules',checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x1dc333,_0x502174)=>{const _0x376f3d=a0_0x27126c,{class_id:_0x49dbdc,day_of_week:_0x1ce205,schedule_date:_0x35cede,start_time:_0x3a9247,end_time:_0xc71280}=_0x1dc333['body'],_0x56a685=_0x376f3d(0x147),_0x2e79de=[_0x49dbdc,_0x1ce205,_0x35cede,_0x3a9247,_0xc71280];sql[_0x376f3d(0x163)](connectionString,_0x56a685,_0x2e79de,_0x6e2c9c=>{const _0x4576e8=_0x376f3d;if(_0x6e2c9c)return console['error']('Insert\x20schedule\x20error:',_0x6e2c9c),_0x502174[_0x4576e8(0x112)](0x1f4)[_0x4576e8(0x164)](_0x4576e8(0x11a));_0x502174[_0x4576e8(0x17b)](_0x4576e8(0x19b));});}),app[a0_0x27126c(0x14b)](a0_0x27126c(0x1b0),checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x17dbfa,_0xb00b8)=>{const _0x2259b9=a0_0x27126c,{class_id:_0x5cdbc0,day_of_week:_0x1791ed,schedule_date:_0x21853c,start_time:_0x3a7c53,end_time:_0x2cbae2}=_0x17dbfa[_0x2259b9(0x139)],_0x597f88=_0x2259b9(0x11c),_0x2c349c=[_0x5cdbc0,_0x1791ed,_0x21853c,_0x3a7c53,_0x2cbae2,_0x17dbfa[_0x2259b9(0x18a)]['id']];sql[_0x2259b9(0x163)](connectionString,_0x597f88,_0x2c349c,_0x40ed50=>{const _0x32da0b=_0x2259b9;if(_0x40ed50)return console['error'](_0x32da0b(0x113),_0x40ed50),_0xb00b8[_0x32da0b(0x112)](0x1f4)['send']('Update\x20failed');_0xb00b8[_0x32da0b(0x17b)]('/schedules');});}),app[a0_0x27126c(0x176)]('/schedules/:id',checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x4233b1,_0x3a8b29)=>{const _0x5325fb=a0_0x27126c,_0xd36886=_0x5325fb(0x1a7);sql[_0x5325fb(0x163)](connectionString,_0xd36886,[_0x4233b1[_0x5325fb(0x18a)]['id']],_0x1dea66=>{const _0x19def8=_0x5325fb;if(_0x1dea66)return console[_0x19def8(0x1b2)](_0x19def8(0x184),_0x1dea66),_0x3a8b29[_0x19def8(0x112)](0x1f4)[_0x19def8(0x164)](_0x19def8(0x104));_0x3a8b29['redirect'](_0x19def8(0x12a));});}),app[a0_0x27126c(0x14b)](a0_0x27126c(0x12a),checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x185f16,_0x1ab6a6)=>{const _0x123870=a0_0x27126c,{class_id:_0x52e4de,day_of_week:_0x30029f,schedule_date:_0x308f06,start_time:_0x1417a1,end_time:_0x6c5dd}=_0x185f16[_0x123870(0x139)],_0x3d1d2f=_0x123870(0x147),_0x412cea=[_0x52e4de,_0x30029f,_0x308f06,_0x1417a1,_0x6c5dd];sql['query'](connectionString,_0x3d1d2f,_0x412cea,_0x1161a4=>{const _0x56a24d=_0x123870;if(_0x1161a4)return console[_0x56a24d(0x1b2)](_0x56a24d(0xe8),_0x1161a4),_0x1ab6a6[_0x56a24d(0x112)](0x1f4)['send']('Insert\x20failed');_0x1ab6a6[_0x56a24d(0x17b)](_0x56a24d(0x12a));});}),app['post'](a0_0x27126c(0x16e),checkAuthenticated,authenticateRole([a0_0x27126c(0x16d),a0_0x27126c(0xc8)]),(_0x5d4d4a,_0x20af9c)=>{const _0x3a3603=a0_0x27126c,{class_name:_0x5f3c74,course_id:_0x37595f,teacher_id:_0x53e487,start_time:_0x5f1fc6,end_time:_0x5c61fa}=_0x5d4d4a[_0x3a3603(0x139)],_0x504bc1=_0x3a3603(0x12e),_0x59662b=[_0x5f3c74,_0x37595f,_0x53e487,_0x5f1fc6,_0x5c61fa,_0x5d4d4a[_0x3a3603(0x18a)]['id']];sql['query'](connectionString,_0x504bc1,_0x59662b,_0xf667d=>{const _0x116a07=_0x3a3603;try{if(_0xf667d)return console[_0x116a07(0x1b2)]('Update\x20class\x20error:',_0xf667d),_0x20af9c[_0x116a07(0x112)](0x1f4)['send']('Update\x20failed');_0x20af9c[_0x116a07(0x17b)](_0x116a07(0x157));}catch(_0x31d24c){_0x31d24c[_0x116a07(0x18d)]!=='ERR_HTTP_HEADERS_SENT'&&console[_0x116a07(0x1b2)](_0x116a07(0x17a),_0x31d24c);}});}),app[a0_0x27126c(0x176)](a0_0x27126c(0x16e),checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x4a8dbb,_0x5c33e3)=>{const _0x409847=a0_0x27126c,_0x353f67=_0x4a8dbb['params']['id'],_0xa7d11e=_0x409847(0x16b);sql[_0x409847(0x163)](connectionString,_0xa7d11e,[_0x353f67],_0x19ceb2=>{const _0x498558=_0x409847;if(_0x19ceb2)return console[_0x498558(0x1b2)](_0x498558(0x137),_0x19ceb2),_0x5c33e3[_0x498558(0x112)](0x1f4)[_0x498558(0x164)](_0x498558(0x1af));_0x5c33e3[_0x498558(0x17b)](_0x498558(0x157));});}),app[a0_0x27126c(0x14b)](a0_0x27126c(0xf2),checkAuthenticated,authenticateRole('admin'),(_0x4689ce,_0x463663)=>{const _0x5c5278=a0_0x27126c,{student_id:_0x2e42c4,class_id:_0x5ea5a2,enrollment_date:_0x4a63d0}=_0x4689ce['body'];if(!_0x2e42c4||!_0x5ea5a2||!_0x4a63d0)return _0x463663[_0x5c5278(0x112)](0x190)[_0x5c5278(0x164)](_0x5c5278(0x14a));const _0x512bcd=_0x5c5278(0x150);sql[_0x5c5278(0x163)](connectionString,_0x512bcd,[_0x2e42c4,_0x5ea5a2,_0x4a63d0],_0x642b7e=>{const _0x5a2ed1=_0x5c5278;if(_0x642b7e)return console['error'](_0x5a2ed1(0x155),_0x642b7e),_0x463663[_0x5a2ed1(0x112)](0x1f4)[_0x5a2ed1(0x164)]('Database\x20error');_0x463663[_0x5a2ed1(0x17b)]('/enrollments');});}),app[a0_0x27126c(0x14b)]('/enrollments/:id',checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x559112,_0x3ec4fe)=>{const _0xd80049=a0_0x27126c,{student_id:_0x14ce11,class_id:_0x2aabf7,enrollment_date:_0x1f8f1f}=_0x559112[_0xd80049(0x139)],_0xcacc09='\x0a\x20\x20\x20\x20UPDATE\x20enrollments\x0a\x20\x20\x20\x20SET\x20student_id\x20=\x20?,\x20class_id\x20=\x20?,\x20enrollment_date\x20=\x20?\x0a\x20\x20\x20\x20WHERE\x20id\x20=\x20?\x0a\x20\x20';sql['query'](connectionString,_0xcacc09,[_0x14ce11,_0x2aabf7,_0x1f8f1f,_0x559112[_0xd80049(0x18a)]['id']],_0x4f3231=>{const _0x26198e=_0xd80049;if(_0x4f3231)return console[_0x26198e(0x1b2)]('Update\x20enrollment\x20error:',_0x4f3231),_0x3ec4fe['status'](0x1f4)[_0x26198e(0x164)](_0x26198e(0xd9));_0x3ec4fe[_0x26198e(0x17b)](_0x26198e(0x10e));});}),app[a0_0x27126c(0x176)](a0_0x27126c(0xe2),checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x1f393a,_0x37304d)=>{const _0x18b26e=a0_0x27126c,_0x4f991f='DELETE\x20FROM\x20enrollments\x20WHERE\x20id\x20=\x20?';sql[_0x18b26e(0x163)](connectionString,_0x4f991f,[_0x1f393a[_0x18b26e(0x18a)]['id']],_0x3e2ab8=>{const _0x4299cf=_0x18b26e;if(_0x3e2ab8)return console[_0x4299cf(0x1b2)](_0x4299cf(0x19a),_0x3e2ab8),_0x37304d['status'](0x1f4)[_0x4299cf(0x164)](_0x4299cf(0x104));_0x37304d[_0x4299cf(0x17b)](_0x4299cf(0x10e));});}),app[a0_0x27126c(0x14b)]('/payments/new',checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x2a09e2,_0x4fc119)=>{const _0x5ab391=a0_0x27126c,{student_id:_0x3aaa2d,amount:_0xa28fed,payment_date:_0x2cce67}=_0x2a09e2[_0x5ab391(0x139)];if(!_0x3aaa2d||!_0xa28fed||!_0x2cce67)return _0x4fc119['status'](0x190)[_0x5ab391(0x164)]('Missing\x20required\x20fields');const _0x3b0236='\x0a\x20\x20\x20\x20INSERT\x20INTO\x20payments\x20(student_id,\x20amount,\x20payment_date)\x0a\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?);\x0a\x20\x20';sql[_0x5ab391(0x163)](connectionString,_0x3b0236,[_0x3aaa2d,_0xa28fed,_0x2cce67],_0x16eac0=>{const _0x4739b9=_0x5ab391;if(_0x16eac0)return console[_0x4739b9(0x1b2)](_0x4739b9(0x188),_0x16eac0),_0x4fc119[_0x4739b9(0x112)](0x1f4)['send']('Database\x20error');_0x4fc119[_0x4739b9(0x17b)](_0x4739b9(0x129));});}),app['post'](a0_0x27126c(0x101),checkAuthenticated,authenticateRole('admin'),(_0x241a97,_0x5a1f38)=>{const _0x23bbf4=a0_0x27126c,{student_id:_0x54b505,amount:_0x147617,payment_date:_0x2eaed7}=_0x241a97[_0x23bbf4(0x139)],_0x260f07=_0x23bbf4(0xc9);sql[_0x23bbf4(0x163)](connectionString,_0x260f07,[_0x54b505,_0x147617,_0x2eaed7,_0x241a97[_0x23bbf4(0x18a)]['id']],_0x2f053a=>{const _0x3509bc=_0x23bbf4;if(_0x2f053a)return console[_0x3509bc(0x1b2)]('Update\x20payment\x20error:',_0x2f053a),_0x5a1f38[_0x3509bc(0x112)](0x1f4)['send']('Update\x20failed');_0x5a1f38['redirect'](_0x3509bc(0x129));});}),app['delete'](a0_0x27126c(0x101),checkAuthenticated,authenticateRole(a0_0x27126c(0x16d)),(_0x12b06c,_0xe558c)=>{const _0x4ab4b6=a0_0x27126c,_0x3e18d6=_0x4ab4b6(0x128);sql[_0x4ab4b6(0x163)](connectionString,_0x3e18d6,[_0x12b06c['params']['id']],_0x53e564=>{const _0x39865a=_0x4ab4b6;if(_0x53e564)return console['error'](_0x39865a(0x100),_0x53e564),_0xe558c['status'](0x1f4)['send'](_0x39865a(0x104));_0xe558c['redirect'](_0x39865a(0x129));});});function checkAuthenticated(_0x568c22,_0x4490e9,_0x36c2ed){const _0x21dc21=a0_0x27126c;if(_0x568c22['isAuthenticated']())return _0x36c2ed();_0x4490e9['redirect'](_0x21dc21(0x1a3));}function a0_0x1f42(){const _0x46c46d=['\x0a\x20\x20\x20\x20UPDATE\x20payments\x0a\x20\x20\x20\x20SET\x20student_id\x20=\x20?,\x20amount\x20=\x20?,\x20payment_date\x20=\x20?\x0a\x20\x20\x20\x20WHERE\x20id\x20=\x20?\x0a\x20\x20','/logout','/courses/new','\x0a\x20\x20\x20\x20\x20\x20\x20\x20INSERT\x20INTO\x20users\x20(username,\x20password,\x20role,\x20created_at,\x20updated_at)\x20VALUES\x20(?,\x20?,\x20?,\x20GETDATE(),\x20GETDATE());\x0a\x20\x20\x20\x20\x20\x20\x20\x20INSERT\x20INTO\x20admins\x20(user_id,\x20full_name,\x20email,\x20phone_number,\x20created_at,\x20updated_at)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20id,\x20?,\x20?,\x20?,\x20GETDATE(),\x20GETDATE()\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20users\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20username\x20=\x20?;\x0a\x20\x20\x20\x20\x20\x20','401443rOudET','\x0a\x20\x20\x20\x20INSERT\x20INTO\x20notifications\x20(user_id,\x20message)\x0a\x20\x20\x20\x20VALUES\x20(?,\x20?);\x0a\x20\x20','Enrollment\x20not\x20found','/materials/:id/edit','Date\x20Range:','editSchedule.ejs','/payments/new','max','express','Salary\x20is\x20required\x20for\x20teachers','numeric','/courses/:id/edit','Update\x20failed','editUser','18441560vSkLbg','\x0a\x20\x20\x20\x20\x09SELECT\x20u.id,\x20u.username,\x20u.role,\x20u.created_at,\x20u.updated_at,\x0a\x20\x20\x20\x20\x20\x20\x20COALESCE(s.full_name,\x20t.full_name,\x20a.full_name)\x20AS\x20full_name,\x0a\x20\x20\x20\x20\x20\x20\x20COALESCE(s.email,\x20t.email,\x20a.email)\x20AS\x20email,\x0a\x20\x20\x20\x20\x20\x20\x20COALESCE(s.phone_number,\x20t.phone_number,\x20a.phone_number)\x20AS\x20phone\x0aFROM\x20users\x20u\x0aLEFT\x20JOIN\x20students\x20s\x20ON\x20u.id\x20=\x20s.user_id\x0aLEFT\x20JOIN\x20teachers\x20t\x20ON\x20u.id\x20=\x20t.user_id\x0aLEFT\x20JOIN\x20admins\x20a\x20\x20\x20ON\x20u.id\x20=\x20a.user_id\x0aORDER\x20BY\x20u.created_at\x20DESC;\x0a\x20\x20','urlencoded','User\x20not\x20found','1213408pkYxbc','INSERT\x20INTO\x20users\x20(username,\x20password,\x20role,\x20created_at,\x20updated_at)\x20VALUES\x20(?,\x20?,\x20?,\x20GETDATE(),\x20GETDATE());\x0a\x20\x20\x20\x20\x20\x20INSERT\x20INTO\x20teachers\x20(user_id,\x20full_name,\x20email,\x20phone_number,\x20address,\x20date_of_birth,\x20salary,\x20created_at,\x20updated_at)\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20id,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20GETDATE(),\x20GETDATE()\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20users\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20username\x20=\x20?;\x0a\x20\x20\x20\x20\x20\x20','Delete\x20error:','/enrollments/:id','editClass.ejs','/users/:id/edit','/notifications','NODE_ENV','Notification\x20sent\x20to\x20user\x20ID:','Insert\x20schedule\x20error:','env','/schedules/:id/edit','Material\x20not\x20found','SELECT\x20*\x20FROM\x20materials\x20ORDER\x20BY\x20uploaded_at\x20DESC','hash','material','length','initialize','enrollments.ejs','/enrollments/new','set','materials.ejs','diskStorage','/upload-material','Schedule\x20data:','unlink','Role:','multer','Schedule\x20not\x20found','slice','\x0a\x20\x20\x20\x20INSERT\x20INTO\x20classes\x20(class_name,\x20course_id,\x20teacher_id,\x20start_time,\x20end_time)\x0a\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?);\x0a\x20\x20','Payment\x20not\x20found','Insert\x20material\x20error:','Delete\x20payment\x20error:','/payments/:id','15yMQVUr','\x0a\x20\x20\x20\x20INSERT\x20INTO\x20materials\x20(course_id,\x20file_name,\x20file_path,\x20mime_type)\x0a\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?)\x0a\x20\x20','Delete\x20failed','Email\x20is\x20required','filename','\x0a\x20\x20\x20\x20INSERT\x20INTO\x20courses\x20(course_name,\x20description,\x20start_date,\x20end_date)\x0a\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?)\x0a\x20\x20','msnodesqlv8','express-flash','Update\x20error','Fetch\x20schedules\x20error:','rowsAffected','SELECT\x20id,\x20full_name\x20FROM\x20students','/enrollments','Thứ\x207','Insert\x20course\x20error:','SELECT\x20id,\x20course_name\x20FROM\x20courses','status','Update\x20schedule\x20error:','SELECT\x20id,\x20class_name\x20FROM\x20classes','SELECT\x20*\x20FROM\x20courses\x20WHERE\x20id\x20=\x20?','Logout\x20error','weekStart','Update\x20material\x20error:','courses.ejs','Insert\x20failed','2-digit','\x0a\x20\x20\x20\x20UPDATE\x20schedules\x0a\x20\x20\x20\x20SET\x20class_id\x20=\x20?,\x20day_of_week\x20=\x20?,\x20schedule_date\x20=\x20?,\x20start_time\x20=\x20?,\x20end_time\x20=\x20?\x0a\x20\x20\x20\x20WHERE\x20id\x20=\x20?\x0a\x20\x20','/upload','_method','user','Update\x20error:','SELECT\x20*\x20FROM\x20users\x20WHERE\x20id\x20=\x20?','\x0a\x20\x20\x20\x20UPDATE\x20users\x20SET\x20username\x20=\x20?,\x20role\x20=\x20?,\x20updated_at\x20=\x20GETDATE()\x0a\x20\x20\x20\x20WHERE\x20id\x20=\x20?\x0a\x20\x20','Course\x20not\x20found','Error\x20during\x20registration:','Student\x20fetch\x20error','SELECT\x20file_path\x20FROM\x20materials\x20WHERE\x20id\x20=\x20?','Fetch\x20payments\x20error:','DELETE\x20FROM\x20payments\x20WHERE\x20id\x20=\x20?','/payments','/schedules','use','join','newSchedule.ejs','\x0a\x20\x20\x20\x20UPDATE\x20classes\x0a\x20\x20\x20\x20SET\x20class_name\x20=\x20?,\x20course_id\x20=\x20?,\x20teacher_id\x20=\x20?,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20start_time\x20=\x20?,\x20end_time\x20=\x20?,\x20updated_at\x20=\x20GETDATE()\x0a\x20\x20\x20\x20WHERE\x20id\x20=\x20?\x0a\x20\x20','local','Newpayments.ejs','file','970236eXGgeg','setDate','SELECT\x20*\x20FROM\x20materials\x20WHERE\x20id\x20=\x20?','ERR_HTTP_HEADERS_SENT','Unauthorized\x20access','Delete\x20class\x20error:','originalname','body','SELECT\x20*\x20FROM\x20payments\x20WHERE\x20id\x20=\x20?','Unauthorized\x20role','classes.ejs','uploads','mkdirSync','Insert\x20error:','DELETE\x20FROM\x20materials\x20WHERE\x20id\x20=\x20?','logOut','\x0a\x20\x20\x20\x20\x20\x20SELECT\x20s.schedule_date,\x20s.start_time,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20c.class_name,\x20t.full_name\x20AS\x20teacher\x0a\x20\x20\x20\x20\x20\x20FROM\x20students\x20st\x0a\x20\x20\x20\x20\x20\x20JOIN\x20enrollments\x20e\x20ON\x20st.id\x20=\x20e.student_id\x0a\x20\x20\x20\x20\x20\x20JOIN\x20classes\x20c\x20\x20\x20\x20\x20ON\x20e.class_id\x20=\x20c.id\x0a\x20\x20\x20\x20\x20\x20JOIN\x20schedules\x20s\x20\x20\x20ON\x20c.id\x20=\x20s.class_id\x0a\x20\x20\x20\x20\x20\x20JOIN\x20teachers\x20t\x20\x20\x20\x20ON\x20c.teacher_id\x20=\x20t.id\x0a\x20\x20\x20\x20\x20\x20WHERE\x20st.user_id\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20\x20\x20AND\x20s.schedule_date\x20BETWEEN\x20?\x20AND\x20?\x0a\x20\x20\x20\x20','/courses','Material\x20uploaded\x20successfully.','UserId:','User\x20ID\x20and\x20message\x20are\x20required.','\x0a\x20\x20\x20\x20INSERT\x20INTO\x20schedules\x20(class_id,\x20day_of_week,\x20schedule_date,\x20start_time,\x20end_time)\x0a\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20','Thứ\x203','express-session','Missing\x20required\x20fields','post','toISOString','Fetch\x20enrollments\x20error:','SELECT\x20*\x20FROM\x20classes\x20WHERE\x20id\x20=\x20?','payments.ejs','\x0a\x20\x20\x20\x20INSERT\x20INTO\x20enrollments\x20(student_id,\x20class_id,\x20enrollment_date)\x0a\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?);\x0a\x20\x20','mimetype','iso','addCourse.ejs','/courses/:id','Enrollment\x20insert\x20error:','Username\x20is\x20required','/classes','console','birthday','SQL\x20error:','Database\x20insert\x20error','\x0a\x20\x20\x20\x20SELECT\x20e.id,\x20s.full_name\x20AS\x20student_name,\x20c.class_name,\x20e.enrollment_date\x0a\x20\x20\x20\x20FROM\x20enrollments\x20e\x0a\x20\x20\x20\x20JOIN\x20students\x20s\x20ON\x20e.student_id\x20=\x20s.id\x0a\x20\x20\x20\x20JOIN\x20classes\x20c\x20ON\x20e.class_id\x20=\x20c.id\x0a\x20\x20\x20\x20ORDER\x20BY\x20e.enrollment_date\x20DESC\x0a\x20\x20','Insert\x20notification\x20error:','register.ejs','DELETE\x20FROM\x20users\x20WHERE\x20id\x20=\x20?','Chủ\x20nhật','Password','SELECT\x20id,\x20full_name\x20FROM\x20teachers','query','send','Thứ\x204','Class\x20fetch\x20error','28190rnbZIX','render','\x0a\x20\x20\x20\x20UPDATE\x20courses\x20\x0a\x20\x20\x20\x20SET\x20course_name\x20=\x20?,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20description\x20=\x20?,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20start_date\x20=\x20?,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20end_date\x20=\x20?,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20=\x20GETDATE()\x0a\x20\x20\x20\x20WHERE\x20id\x20=\x20?\x0a\x20\x20','editCourse','DELETE\x20FROM\x20classes\x20WHERE\x20id\x20=\x20?','SECRET_KEY','admin','/classes/:id','bcrypt','Driver={ODBC\x20Driver\x2017\x20for\x20SQL\x20Server};Server=LAPTOP-ND7KAD0J;Database=DOANCS;Trusted_Connection=Yes;','role','SELECT\x20*\x20FROM\x20courses\x20ORDER\x20BY\x20start_date\x20DESC','view\x20engine','File\x20deletion\x20error:','getDate','delete','log','file_path','addClass.ejs','Unhandled\x20error:','redirect','start_time','\x0a\x20\x20\x20\x20\x20\x20SELECT\x20s.schedule_date,\x20s.start_time,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20c.class_name,\x20NULL\x20AS\x20teacher\x0a\x20\x20\x20\x20\x20\x20FROM\x20teachers\x20t\x0a\x20\x20\x20\x20\x20\x20JOIN\x20classes\x20c\x20\x20\x20\x20ON\x20t.id\x20=\x20c.teacher_id\x0a\x20\x20\x20\x20\x20\x20JOIN\x20schedules\x20s\x20\x20ON\x20c.id\x20=\x20s.class_id\x0a\x20\x20\x20\x20\x20\x20WHERE\x20t.user_id\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20\x20\x20AND\x20s.schedule_date\x20BETWEEN\x20?\x20AND\x20?\x0a\x20\x20\x20\x20','method-override','Notification\x20sent\x20successfully!','/materials','index.ejs','single','Missing\x20course_id\x20or\x20file.','Delete\x20schedule\x20error:','Tiết\x20','\x0a\x20\x20\x20\x20SELECT\x20c.*,\x20co.course_name,\x20t.full_name\x20AS\x20teacher_name\x0a\x20\x20\x20\x20FROM\x20classes\x20c\x0a\x20\x20\x20\x20JOIN\x20courses\x20co\x20ON\x20c.course_id\x20=\x20co.id\x0a\x20\x20\x20\x20JOIN\x20teachers\x20t\x20ON\x20c.teacher_id\x20=\x20t.id\x0a\x20\x20\x20\x20ORDER\x20BY\x20c.created_at\x20DESC\x0a\x20\x20','SELECT\x20*\x20FROM\x20enrollments\x20WHERE\x20id\x20=\x20?','Payment\x20insert\x20error:','Classes\x20fetch\x20error','params','editPayment.ejs','Course\x20added:','code','1997193NbqsBT','/schedule/new','get','Address\x20is\x20required','userList','existsSync','Not\x20found','schedule_date','42VaZpJr','Date\x20of\x20birth\x20is\x20required','/classes/:id/edit','35288eadrBf','Delete\x20enrollment\x20error:','/schedule','DELETE\x20FROM\x20courses\x20WHERE\x20id\x20=\x20?','File\x20uploaded\x20and\x20saved\x20to\x20database.','Thứ\x206','from','notifications.ejs','subject','/register','/login','student','passport','Teacher\x20fetch\x20error','DELETE\x20FROM\x20schedules\x20WHERE\x20id\x20=\x20?','editEnrollment.ejs','/materials/:id','Delete\x20error','./pass-config','90Uthfzz','Thứ\x205','Fetch\x20classes\x20error:','Delete\x20failed.xóa\x20hết\x20học\x20viên\x20trong\x20lớp\x20nếu\x20chưa\x20xóa','/schedules/:id','Fetch\x20materials\x20error:','error','/uploads','Only\x20staff\x20can\x20send\x20notifications.','uploadMaterial.ejs','/payments/:id/edit','toLocaleDateString','getDay','Addenrollments.ejs','schedules.ejs','\x20\x0a\x20\x20\x20\x20\x20\x20SELECT\x20u.*\x0a\x20\x20\x20\x20\x20\x20FROM\x20users\x20u\x0a\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20students\x20s\x20ON\x20u.id\x20=\x20s.user_id\x0a\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20teachers\x20t\x20ON\x20u.id\x20=\x20t.user_id\x0a\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20admins\x20a\x20ON\x20u.id\x20=\x20a.user_id\x0a\x20\x20\x20\x20\x20\x20WHERE\x20s.email\x20=\x20?\x20OR\x20t.email\x20=\x20?\x20OR\x20a.email\x20=\x20?\x0a\x20\x20\x20\x20','schedule','/users/:id','./roleAuth','Database\x20error','SELECT\x20*\x20FROM\x20schedules\x20WHERE\x20id\x20=\x20?','teacher'];a0_0x1f42=function(){return _0x46c46d;};return a0_0x1f42();}function checkNotAuthenticated(_0x4488ab,_0x2ad4eb,_0x6dcaad){if(_0x4488ab['isAuthenticated']())return _0x2ad4eb['redirect']('/');_0x6dcaad();}app['listen'](0xbb8);